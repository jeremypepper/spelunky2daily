(this["webpackJsonpspelunky2-daily-leaderboards"]=this["webpackJsonpspelunky2-daily-leaderboards"]||[]).push([[0],{10:function(e,t,n){var a=n(81),r=n(82),c=n(83).DateTime;var i=new RegExp("[^A-Za-z0-9\\-_]","g");var s=function(){"use strict";function e(t,n,r,c){a(this,e),this.value=t,this.world=n,this.sublevel=r,this.worldName=c}return r(e,[{key:"toString",value:function(){return 0===this.world&&0===this.sublevel?"":"".concat(this.world,"-").concat(this.sublevel)}}]),e}();e.exports={parseDate:function(e){return c.fromFormat(e,"yyyy-MM-dd",{zone:"utc"}).valueOf()},getLevelDefinition:function(e){return null==e?new s(0,0,0,""):e<=4?new s(e,1,e,"dwelling"):e<=8?new s(e,2,e-4,"volcana/jungle"):9===e?new s(e,3,1,"olmec"):e<=13?new s(e,4,e-9,"tidepool/temple"):e<=14?new s(e,5,1,"icecaves"):e<=18?new s(e,6,e-14,"neobabylon"):new s(e,7,e-18,e<=22?"sunkencity":"cosmic ocean")},getPlayerName:function(e){return e?e.replace(i,"__"):""}}},108:function(e,t,n){},109:function(e,t,n){"use strict";n.r(t);var a=n(48),r=n.n(a),c=n(62),i=n(1),s=n(2),l=n.n(s),o=n(63),j=n.n(o),u=(n(77),n(16)),d=(n(78),n(6)),h=n.n(d),b=n(47),f=n(125),x=n(120),O=n(121),p=n(122),m=n(123),v=n(119),y=n(64),D=n.n(y),w=n(124),g=n(10),S=n(34),F=n.n(S),k=n(21),N=n.n(k);function B(e){var t=function(e){return e.level}(e);return t>23?23:t}function E(e){if(!e.dayData)return null;for(var t,n=(t=e.dayData,h.a.countBy(t,B)),a=[0],r=h.a.max(h.a.keys(n).map((function(e){return Number.parseInt(e,10)}))),c=1;c<=r;c++)a[c]=n[c]||0;var s={chart:{type:"column"},plotOptions:{column:{colorByPoint:!0},series:{minPointLength:3}},colors:["#8B786D","#8B786D","#8B786D","#8B786D","#8B786D","#590925","#590925","#590925","#590925","#F6AA1C","#16425B","#16425B","#16425B","#16425B","#78A1BB","#DAD4EF","#DAD4EF","#DAD4EF","#DAD4EF","#9CDE9F","#9CDE9F","#9CDE9F","#9CDE9F","#002626"],title:{text:"Maximum World Reached"},credits:{enabled:!1},legend:{enabled:!1},yAxis:{title:{text:"Number of Players"}},xAxis:{min:1,max:23,tickPositions:[1,5,9,10,14,15,19,23],labels:{formatter:function(){var e=Object(g.getLevelDefinition)(this.value);return 23===e.value?"ocean":"".concat(e.toString())}},crosshair:!0},series:[{name:"WorldEntered",data:a}],tooltip:{formatter:function(){var e=Object(g.getLevelDefinition)(this.x);return"".concat(e.worldName," ").concat(e.toString(),"<br/>").concat(this.y," players")}}},l=function(){return Object(i.jsx)("div",{children:Object(i.jsx)(F.a,{highcharts:N.a,options:s})})};return Object(i.jsx)(l,{})}var L="localhost"===window.location.hostname?"http://localhost:8010/proxy":"https://spelunky2daily.s3-us-west-2.amazonaws.com";function C(e){return fetch(L+e)}function P(e){var t=D()({table:{minWidth:650}})();if(!e.dayData)return null;var n=e.filterCount?h.a.take(e.dayData,e.filterCount):e.dayData,a=h.a.map(n,(function(e){var t=Object(g.getLevelDefinition)(e.level);return Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:Object(i.jsx)("a",{href:"?player=".concat(e.name),children:e.name})}),Object(i.jsx)(f.a,{children:18===e.platform?"Steam":"Playstation"}),Object(i.jsx)(f.a,{children:t.toString()}),Object(i.jsx)(f.a,{children:e.percentile.toFixed(2)})]},e.id)}));return Object(i.jsx)("div",{children:Object(i.jsx)(x.a,{component:O.a,children:Object(i.jsxs)(p.a,{className:t.table,size:"small",children:[Object(i.jsx)(m.a,{children:Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:"Name"}),Object(i.jsx)(f.a,{children:"Platform"}),Object(i.jsx)(f.a,{children:"Level"}),Object(i.jsx)(f.a,{children:"Percentile"})]})}),Object(i.jsx)(w.a,{children:a})]})})})}var A=function(e){var t=Object(s.useState)(100),n=Object(u.a)(t,2),a=n[0],r=n[1],c=window.lastDayJSON;function l(e,t){var n=b.DateTime.fromMillis(Object(g.parseDate)(e)).plus({days:t}),a=n.toUTC().toFormat("yyyy-MM-dd");return function(e){return h.a.includes(c.dates,e)}(a)?a:null}var o=Object(s.useState)(null),j=Object(u.a)(o,2),d=j[0],f=j[1],x=e.day;Object(s.useEffect)((function(){C("/processeddates/"+x+".json").then((function(e){return e.json()})).then((function(e){f(e)}))}),[x]);var O=function(e){return l(e,-1)}(x),p=function(e){return l(e,1)}(x),m=O?Object(i.jsx)("a",{href:"?day="+O,children:"Previous Day"}):null,v=p?Object(i.jsx)("a",{href:"?day="+p,children:"Next Day"}):null;return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("header",{children:[Object(i.jsxs)("div",{className:"main",children:["Daily Challenge for ",x]}),Object(i.jsxs)("div",{className:"subtitle",children:["Data Provided by "," ",Object(i.jsx)("a",{href:"http://vdzserver.org/spelunky2",children:"http://vdzserver.org/spelunky2"})]}),Object(i.jsxs)("nav",{className:"day-nav",children:[m,v,Object(i.jsx)("a",{href:"?path=leaderboards",children:"Leaderboards"})]})]}),Object(i.jsx)("div",{className:"histogram-wrapper",children:Object(i.jsx)(E,{dayData:d})}),Object(i.jsx)(P,{dayData:d,filterCount:a}),a?Object(i.jsxs)("div",{children:["Showing Top 100 players ",Object(i.jsx)("button",{onClick:function(){r(null)},children:"Show All"})]}):null]})},M=(n(108),n(47).DateTime);var T=function(e){var t=Object(s.useState)(null),n=Object(u.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(null),l=Object(u.a)(c,2),o=l[0],j=l[1],d=e.player;if(Object(s.useEffect)((function(){var e;(e=d,fetch("https://tfyx29y4wl.execute-api.us-west-2.amazonaws.com/prod/player?name="+Object(g.getPlayerName)(e)).then((function(e){return e.json()})).then((function(e){return null===e||void 0===e?void 0:e.data}))).then((function(e){r(e)}))}),[d]),Object(s.useEffect)((function(){C("/percentilesByDate.json").then((function(e){return e.json()})).then((function(e){return j(e)}))}),[]),!a)return null;function b(e,t){return Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:e}),Object(i.jsx)(f.a,{children:t})]})}var x,O=[b("Best Rank","".concat(a.rankSummary.min," (").concat(a.percentileSummary.max.toFixed(2),")%")),b("Median Rank","".concat(a.rankSummary.median," (").concat(a.percentileSummary.median.toFixed(2),")%"))],y=h.a.map(a.scoreData,(function(e,t){return function(e,t){return Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:e}),Object(i.jsx)(f.a,{children:t.level}),Object(i.jsx)(f.a,{children:t.score}),Object(i.jsx)(f.a,{children:(t.runframes/60).toFixed(3)}),Object(i.jsx)(f.a,{children:t.rank}),Object(i.jsx)(f.a,{children:t.percentile.toFixed(2)})]})}(t,e)})),D=(x=a.scoreData,h.a.map(x,(function(e,t){return[Object(g.parseDate)(t),e.level]})).reverse()),S=[],k=[],B=[],E=[],L=[],P=[],A=[];h.a.forEach(D,(function(e){var t=M.fromMillis(e[0],{zone:"UTC"}),n=o[t.toString()];n&&(S.push([e[0],n.p25]),k.push([e[0],n.p50]),B.push([e[0],n.p75]),E.push([e[0],n.p80]),L.push([e[0],n.p90]),P.push([e[0],n.p95]),A.push([e[0],n.p99]))}));var T={credits:{enabled:!1},chart:{type:"spline"},title:{text:"Depth Over Time"},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x:%m-%d}: {point.y}",formatter:function(){var e=Object(g.getLevelDefinition)(this.y),t=N.a.dateFormat("%m-%d-%Y",new Date(this.x));return"".concat(t," <br/>").concat(e.worldName," ").concat(e.toString(),"<br/>")}},xAxis:{type:"datetime",title:{text:"Daily"}},yAxis:{title:{text:"Depth (floors reached)"},min:1,labels:{formatter:function(){var e=Object(g.getLevelDefinition)(this.value);return 23===e.value?"ocean":"".concat(e.toString())}}},legend:{enabled:!0},series:[{name:d,data:D},{name:"50th percentile",color:"#DDDDDD",dashStyle:"ShortDash",data:k}]},z=function(){return Object(i.jsx)("div",{children:Object(i.jsx)(F.a,{highcharts:N.a,options:T})})};return Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:"title",children:a.name}),Object(i.jsx)(p.a,{children:Object(i.jsx)(w.a,{children:O})}),Object(i.jsx)(z,{}),Object(i.jsxs)(p.a,{children:[Object(i.jsxs)(m.a,{children:[Object(i.jsx)(f.a,{children:"date"}),Object(i.jsx)(f.a,{children:"level"}),Object(i.jsx)(f.a,{children:"score"}),Object(i.jsx)(f.a,{children:"time"}),Object(i.jsx)(f.a,{children:"rank"}),Object(i.jsx)(f.a,{children:"percentile"})]}),Object(i.jsx)(w.a,{children:y})]})]})};function z(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1];Object(s.useEffect)((function(){C("/tenDayLevelScoreList.json").then((function(e){return e.json()})).then((function(e){return h.a.forEach(e,(function(e,t){var n=[];h.a.forEach(e.tenDayLevelsReached,(function(e,t){e&&n.push(e*Math.pow(.9,t))}));var a=h.a.sum(n);e.totalScore=a})),h()(e).sortBy("totalScore").reverse().value()})).then((function(e){return a(e)}))}),[]);var r=h.a.map(n,(function(e,t){var n=h.a.map(e.tenDayLevelsReached,(function(e){return Object(g.getLevelDefinition)(e).toString()}));return Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:t+1}),Object(i.jsx)(f.a,{children:e.playerName}),Object(i.jsx)(f.a,{children:e.totalScore.toFixed(2)}),h.a.map(n,(function(e){return Object(i.jsx)(f.a,{style:{whiteSpace:"nowrap"},children:e})}))]},e.playerName)}));return Object(i.jsxs)("div",{children:[Object(i.jsxs)("header",{children:["Spelunky 2 Leaderboards",Object(i.jsx)("div",{className:"subtitle",children:"Calculated using the last 10 days. More recent days have a higher influence on total score"})]}),Object(i.jsxs)("div",{style:{width:1024},children:[Object(i.jsxs)(p.a,{size:"small",children:[Object(i.jsx)(m.a,{children:Object(i.jsxs)(v.a,{children:[Object(i.jsx)(f.a,{children:"Rank"}),Object(i.jsx)(f.a,{children:"Player"}),Object(i.jsx)(f.a,{children:"Total Ten Day Score"}),Object(i.jsx)(f.a,{colSpan:10,children:"Results"})]})}),Object(i.jsx)(w.a,{children:r})]}),Object(i.jsx)("footer",{})]})]})}var R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};function J(){return(J=Object(c.a)(r.a.mark((function e(){var t,n,a,c,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C("/latest-date.json").then((function(e){return e.json()}));case 2:window.lastDayJSON=e.sent,t=new URLSearchParams(window.location.search),a=t.get("player"),c=t.get("path"),s=t.get("day")||window.lastDayJSON.date,n=a?Object(i.jsx)(T,{player:a}):"leaderboards"===c?Object(i.jsx)(z,{}):Object(i.jsx)(A,{day:s}),j.a.render(Object(i.jsx)(l.a.StrictMode,{children:n}),document.getElementById("root"));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){J.apply(this,arguments)}(),R()},77:function(e,t,n){},78:function(e,t,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.ef6a3218.chunk.js.map